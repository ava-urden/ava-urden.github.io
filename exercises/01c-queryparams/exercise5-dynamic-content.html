<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <title>Exercise 5: Dynamic Content Loading</title>

  <script>window.dataLayer = window.dataLayer || [];</script>
  <!-- Google Tag Manager -->
  <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
    var f=d.getElementsByTagName(s)[0], j=d.createElement(s), dl=l!='dataLayer'?'&l='+l:'';
    j.async=true; j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
    f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5JMB8KM3');
  </script>
  <!-- End Google Tag Manager -->

  <style>
    body { margin: 24px; font-family: system-ui, Inter, Arial, sans-serif; }
    nav { display: flex; gap: 15px; margin-bottom: 20px; }
    a { text-decoration: none; padding: 6px 10px; border: 1px solid #ddd; border-radius: 8px; }
  </style>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const urlParams = new URLSearchParams(window.location.search);
      const pageId = (urlParams.get('page') || 'home').toLowerCase();
      const referrer = urlParams.get('ref') || 'direct';

      const pageContent = {
        home:   { title: 'Welcome to our Homepage', content: 'This is the main page content.' },
        about:  { title: 'About Our Company',       content: 'Learn more about what we do.' },
        contact:{ title: 'Contact Us Today',        content: 'Reach out to our team.' }
      };

      const pageHeading = document.getElementById('page-heading');
      const contentArea = document.getElementById('content-area');

      if (pageContent[pageId]) {
        pageHeading.innerText = pageContent[pageId].title;
        contentArea.innerText = pageContent[pageId].content;
      } else {
        pageHeading.innerText = 'Page Not Found';
        contentArea.innerText = 'The requested page does not exist.';
      }

      document.querySelectorAll('.nav-link').forEach(link => {
        const page = link.getAttribute('data-page');
        link.href = `?page=${page}&ref=navigation`;
      });

      window.dataLayer.push({
        event: 'virtual_page_view',
        page_id: pageId,
        referrer: referrer,
        timestamp_iso: new Date().toISOString()
      });
      console.log('DL:', window.dataLayer);
    });
  </script>
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5JMB8KM3"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <nav>
    <a href="?page=home&ref=navigation" class="nav-link" data-page="home">Home</a>
    <a href="?page=about&ref=navigation" class="nav-link" data-page="about">About</a>
    <a href="?page=contact&ref=navigation" class="nav-link" data-page="contact">Contact</a>
  </nav>

  <h1 id="page-heading">Welcome</h1>
  <div id="content-area">Loading content...</div>

  <p>Testa: <code>?page=about&ref=example</code></p>
</body>
</html>
