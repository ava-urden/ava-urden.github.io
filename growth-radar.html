<!doctype html>
<html lang="sv">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Ava Growth Radar | Ava Urdén</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&display=swap" rel="stylesheet" />
    <style>
      :root {
        --green:#14471d;
        --green2:#0f3817;
        --cream:#ffffff;
        --coral:#ef7ea1;
        --ink:#0b2210;
        --line: rgba(243,234,212,0.18);
        --shadow: 0 12px 32px rgba(0,0,0,0.35);

        --header-height: 76px;
        --max: 1180px;
        --pad: 32px;
        --radius-lg: 22px;
        --radius-md: 16px;

        --font-head: "Lato", "Helvetica Neue", Arial, sans-serif;
        --font-body: "Lato", "Helvetica Neue", Arial, sans-serif;
        --accent-dark: #0c1c12;
      }

      * { box-sizing: border-box; }

      html { font-size: 16px; scroll-behavior: smooth; }

      body {
        margin: 0;
        font-family: var(--font-body);
        color: var(--cream);
        background: linear-gradient(160deg, var(--green), var(--green2));
        min-height: 100vh;
        line-height: 1.6;
        position: relative;
      }

      body::before {
        content: "";
        position: fixed;
        inset: 0;
        background: radial-gradient(600px 380px at 80% 10%, rgba(239,126,161,0.28), transparent 60%);
        pointer-events: none;
        z-index: 0;
      }

      body::after {
        content: "";
        position: fixed;
        inset: 0;
        background-image: radial-gradient(rgba(255,255,255,0.06) 1px, transparent 1px);
        background-size: 3px 3px;
        opacity: 0.18;
        mix-blend-mode: soft-light;
        pointer-events: none;
        z-index: 0;
      }

      a { color: inherit; text-decoration: none; }
      img { max-width: 100%; display: block; }

      .container {
        max-width: var(--max);
        margin: 0 auto;
        padding: 0 var(--pad);
        width: 100%;
      }

      .section-block {
        padding: clamp(48px, 6vw, 84px) 0;
        position: relative;
        z-index: 1;
      }

      main { padding-top: var(--header-height); position: relative; z-index: 1; }

      h1, h2, h3, h4 {
        font-family: var(--font-head);
        font-weight: 700;
        margin: 0 0 12px;
        line-height: 1.2;
        color: var(--cream);
      }

      .h-display {
        font-size: clamp(2.2rem, 5vw, 3.6rem);
        letter-spacing: -0.02em;
      }

      .hero__p {
        color: rgba(255,255,255,0.72);
        max-width: 720px;
        margin: 0;
      }

      .eyebrow {
        text-transform: uppercase;
        letter-spacing: 0.2em;
        font-size: 0.72rem;
        color: rgba(255,255,255,0.68);
        margin: 8px 0 12px;
      }

      .muted { color: rgba(255,255,255,0.68); }

      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        border: 0;
        white-space: nowrap;
      }

      .back-link {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        margin-bottom: 28px;
        height: 3em;
        padding: 0 16px;
        min-width: 140px;
        text-decoration: none;
        color: #111111;
        font-weight: 500;
        letter-spacing: 0.08em;
        border-radius: 3px;
        transition: all 0.2s linear;
        cursor: pointer;
        border: none;
        background: #ffffff;
        box-shadow: 0 10px 24px rgba(0, 0, 0, 0.08);
      }

      .back-link:hover {
        transform: translateY(-2px);
        box-shadow: 0 14px 28px rgba(0, 0, 0, 0.12);
      }

      /* Header (from Tabless base) */
      .header {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        z-index: 100;
        height: var(--header-height);
        display: flex;
        align-items: center;
        background: rgba(30, 27, 24, 0.92);
        border-bottom: 1px solid rgba(255, 255, 255, 0.04);
        transition: background 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
      }

      .header--scrolled {
        background: rgba(30, 27, 24, 0.98);
        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      }

      .header__inner {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 20px;
        width: 100%;
      }

      .logo {
        font-family: var(--font-head);
        font-weight: 700;
        font-size: 0.9rem;
        letter-spacing: 0.2em;
        text-transform: uppercase;
        white-space: nowrap;
        color: #f6f2ec;
      }

      .nav {
        display: none;
        gap: 26px;
      }

      @media (min-width: 900px) {
        .nav { display: flex; }
      }

      .nav a {
        font-size: 0.72rem;
        text-transform: uppercase;
        letter-spacing: 0.24em;
        color: rgba(246, 242, 236, 0.76);
        font-weight: 500;
      }

      .nav a:hover,
      .nav a.is-active {
        color: #ffffff;
      }

      .lang {
        display: flex;
        gap: 6px;
        padding: 4px 8px;
        border-radius: 999px;
        border: 1px solid rgba(246, 242, 236, 0.28);
        background: rgba(246, 242, 236, 0.12);
      }

      .lang__btn {
        background: none;
        border: none;
        padding: 2px 8px;
        font-size: 0.7rem;
        letter-spacing: 0.28em;
        text-transform: uppercase;
        color: rgba(246, 242, 236, 0.78);
        cursor: pointer;
        font-family: inherit;
      }

      .lang__btn.is-active { color: #ffffff; }

      /* Controls */
      .radar__hero {
        display: grid;
        gap: 24px;
        grid-template-columns: 1fr;
        align-items: center;
        margin-bottom: 26px;
      }

      @media (min-width: 900px) {
        .radar__hero {
          grid-template-columns: 1.2fr 0.8fr;
          align-items: end;
        }
      }

      .radar__controls {
        display: grid;
        gap: 14px;
        justify-items: start;
      }

      .timestamp {
        font-size: 0.85rem;
        color: rgba(255,255,255,0.7);
      }

      .controls-row {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        align-items: center;
      }

      .search {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 14px;
        border-radius: 999px;
        border: 1px solid var(--line);
        background: rgba(255,255,255,0.08);
        min-width: 220px;
      }

      .search input {
        background: transparent;
        border: none;
        color: var(--cream);
        outline: none;
        font-size: 0.85rem;
        width: 100%;
      }

      .search input::placeholder { color: rgba(255,255,255,0.5); }

      /* Buttons */
      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        padding: 12px 26px;
        border-radius: 999px;
        font-size: 0.7rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.18em;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 1px solid transparent;
        font-family: inherit;
      }

      .btn--light {
        background: #ffffff;
        color: var(--ink);
        border: 1px solid #ffffff;
      }

      .btn--light:hover { transform: translateY(-2px); }

      .btn--white {
        background: #ffffff;
        color: var(--ink);
        border: 1px solid #ffffff;
        font-weight: 600;
      }

      .btn--white:hover { transform: translateY(-2px); }

      .btn--outline {
        background: transparent;
        color: #ffffff;
        border: 1px solid rgba(255, 255, 255, 0.85);
      }

      .btn--outline:hover { transform: translateY(-2px); }

      .btn--ghost {
        background: rgba(255,255,255,0.08);
        color: #ffffff;
        border: 1px solid var(--line);
      }

      .btn--ghost:hover { transform: translateY(-2px); }

      .btn--small {
        padding: 8px 16px;
        font-size: 0.62rem;
        letter-spacing: 0.14em;
      }

      /* Dashboard */
      .dashboard {
        display: grid;
        gap: 22px;
        grid-template-columns: repeat(12, minmax(0, 1fr));
      }

      .card {
        border-radius: var(--radius-lg);
        border: 1px solid var(--line);
        background: rgba(255,255,255,0.06);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        box-shadow: var(--shadow);
        padding: 22px;
        position: relative;
        overflow: hidden;
      }

      .card--viral { grid-column: span 6; }
      .card--buzz { grid-column: span 6; }
      .card--pulse { grid-column: 1 / -1; }
      .card--fx { grid-column: span 6; }
      .card--weather { grid-column: span 6; }
      .card--pinterest { grid-column: 1 / -1; }

      @media (max-width: 960px) {
        .dashboard { grid-template-columns: repeat(6, minmax(0, 1fr)); }
        .card--viral, .card--buzz, .card--pulse,
        .card--fx, .card--weather { grid-column: 1 / -1; }
      }

      @media (max-width: 640px) {
        .dashboard { grid-template-columns: 1fr; }
        .card { padding: 18px; }
        .search { min-width: 0; width: 100%; }
        .controls-row { width: 100%; }
      }

      .card__header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
        flex-wrap: wrap;
        margin-bottom: 16px;
      }

      .card__heading {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .icon-circle {
        width: 34px;
        height: 34px;
        border-radius: 50%;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        background: rgba(239,126,161,0.2);
        border: 1px solid rgba(239,126,161,0.4);
        color: #fff;
        font-size: 0.9rem;
      }

      .card__heading h2 {
        font-size: 1.05rem;
        margin: 0;
      }

      .tag {
        display: inline-flex;
        align-items: center;
        padding: 4px 10px;
        border-radius: 999px;
        border: 1px solid var(--line);
        background: rgba(255,255,255,0.08);
        font-size: 0.62rem;
        letter-spacing: 0.12em;
        text-transform: uppercase;
        color: rgba(255,255,255,0.7);
        margin-top: 4px;
      }

      .card__actions {
        display: flex;
        align-items: center;
        gap: 10px;
        flex-wrap: wrap;
      }

      .chip-group {
        display: flex;
        gap: 6px;
        flex-wrap: wrap;
      }

      .chip-group--static {
        margin: 10px 0 12px;
      }

      .chip {
        padding: 6px 12px;
        border-radius: 999px;
        border: 1px solid var(--line);
        background: rgba(255,255,255,0.04);
        color: rgba(255,255,255,0.78);
        font-size: 0.62rem;
        letter-spacing: 0.16em;
        text-transform: uppercase;
        cursor: pointer;
        font-family: inherit;
      }

      .chip.is-active {
        background: rgba(239,126,161,0.22);
        border-color: rgba(239,126,161,0.6);
        color: #fff;
      }

      .chip--static {
        cursor: default;
      }

      .kebab {
        width: 34px;
        height: 34px;
        border-radius: 50%;
        border: 1px solid transparent;
        background: transparent;
        color: rgba(255,255,255,0.7);
        cursor: pointer;
        font-size: 1.2rem;
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }

      .kebab:hover {
        border-color: var(--line);
        background: rgba(255,255,255,0.08);
      }

      .list {
        list-style: none;
        padding: 0;
        margin: 0;
        display: grid;
        gap: 12px;
      }

      .list__item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 10px 12px;
        border-radius: 14px;
        background: rgba(255,255,255,0.05);
        border: 1px solid rgba(255,255,255,0.06);
      }

      .rank {
        min-width: 30px;
        height: 30px;
        border-radius: 8px;
        background: rgba(255,255,255,0.08);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 0.75rem;
      }

      .list__text {
        flex: 1;
        display: grid;
        gap: 4px;
      }

      .list__title {
        font-size: 0.92rem;
        font-weight: 600;
        color: #fff;
      }

      .list__meta {
        font-size: 0.75rem;
        color: rgba(255,255,255,0.6);
      }

      .list__link {
        font-size: 0.72rem;
        text-transform: uppercase;
        letter-spacing: 0.18em;
        color: rgba(255,255,255,0.7);
      }

      .list__link:hover { color: #fff; }

      .list__empty {
        padding: 14px;
        border-radius: 14px;
        border: 1px dashed var(--line);
        color: rgba(255,255,255,0.7);
      }

      .skeleton {
        position: relative;
        overflow: hidden;
      }

      .skeleton__bar {
        height: 14px;
        width: 100%;
        border-radius: 8px;
        background: rgba(255,255,255,0.08);
        position: relative;
        overflow: hidden;
        flex: 1;
      }

      .skeleton__bar::after {
        content: "";
        position: absolute;
        inset: 0;
        transform: translateX(-100%);
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        animation: shimmer 1.4s infinite;
      }

      @keyframes shimmer {
        100% { transform: translateX(100%); }
      }

      .error {
        padding: 14px;
        border-radius: 14px;
        border: 1px solid rgba(255,255,255,0.2);
        background: rgba(255,80,80,0.08);
        color: rgba(255,255,255,0.85);
      }

      .error a {
        text-decoration: underline;
        margin-left: 6px;
      }

      /* FX / KPIs */
      .kpi-grid {
        display: grid;
        gap: 10px;
      }

      .kpi-pill {
        padding: 10px 12px;
        border-radius: 999px;
        border: 1px solid var(--line);
        background: rgba(255,255,255,0.08);
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-size: 0.85rem;
      }

      .kpi-pill strong { font-size: 1rem; }

      .delta {
        font-size: 0.75rem;
        margin-left: 8px;
      }

      .delta.up { color: #b9f6c1; }
      .delta.down { color: #ffb2b2; }

      /* Weather */
      .weather__form {
        display: flex;
        gap: 8px;
        align-items: center;
        margin-bottom: 12px;
      }

      .weather__form input {
        flex: 1;
        background: rgba(255,255,255,0.08);
        border: 1px solid var(--line);
        color: #fff;
        border-radius: 999px;
        padding: 8px 12px;
        font-size: 0.85rem;
        outline: none;
      }

      .token-row {
        display: flex;
        gap: 8px;
        align-items: center;
        flex-wrap: wrap;
        margin: 12px 0;
      }

      .token-row input {
        flex: 1;
        background: rgba(255,255,255,0.08);
        border: 1px solid var(--line);
        color: #fff;
        border-radius: 999px;
        padding: 8px 12px;
        font-size: 0.85rem;
        outline: none;
        min-width: 180px;
      }

      .status-pill {
        display: inline-flex;
        align-items: center;
        padding: 6px 12px;
        border-radius: 999px;
        background: rgba(239,126,161,0.22);
        border: 1px solid rgba(239,126,161,0.5);
        font-size: 0.7rem;
        text-transform: uppercase;
        letter-spacing: 0.16em;
        color: #fff;
      }

      .weather__summary {
        margin-top: 10px;
        color: rgba(255,255,255,0.7);
        font-size: 0.85rem;
      }

      /* Signal meter */
      .meter {
        display: grid;
        gap: 14px;
      }

      .meter__track {
        position: relative;
        height: 10px;
        border-radius: 999px;
        background: rgba(255,255,255,0.12);
        overflow: hidden;
      }

      .meter__fill {
        position: absolute;
        inset: 0;
        width: 0%;
        background: linear-gradient(90deg, rgba(239,126,161,0.8), rgba(255,255,255,0.9));
        transition: width 0.4s ease;
      }

      .meter__labels {
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-size: 0.85rem;
      }

      .meter__stats {
        display: grid;
        gap: 8px;
      }

      .stat {
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-size: 0.85rem;
        color: rgba(255,255,255,0.7);
      }

      .stat__value { color: #fff; font-weight: 600; }

      /* Manifesto */
      .manifesto__line {
        font-size: 1.3rem;
        font-weight: 600;
        margin: 16px 0 10px;
        color: #fff;
      }

      .manifesto__meta {
        display: grid;
        gap: 10px;
        margin-top: 12px;
        color: rgba(255,255,255,0.75);
        font-size: 0.9rem;
      }

      .manifesto__meta span {
        display: block;
      }

      .manifesto__buttons {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-top: 16px;
      }

      /* Footer (from Tabless base) */
      .footer {
        background: var(--accent-dark);
        color: #fff;
        padding: 90px 0 60px;
        border-radius: 0;
      }

      .footer__grid,
      .footer__bottom {
        max-width: 1060px;
        margin: 0 auto;
      }

      .footer__grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 50px;
        margin-bottom: 60px;
      }

      @media (min-width: 900px) {
        .footer__grid { grid-template-columns: 1fr 1fr; }
      }

      .footer h2 {
        color: #fff;
        font-size: 2.3rem;
        margin-bottom: 24px;
      }

      .footer__text {
        color: rgba(255, 255, 255, 0.7);
        font-size: 1.05rem;
        max-width: 460px;
        margin-bottom: 30px;
      }

      .footer__right {
        display: flex;
        flex-direction: column;
        gap: 28px;
      }

      @media (min-width: 900px) {
        .footer__right {
          align-items: flex-end;
          text-align: right;
        }
      }

      .contact-label {
        display: block;
        font-size: 0.7rem;
        text-transform: uppercase;
        letter-spacing: 0.2em;
        color: rgba(255, 255, 255, 0.6);
        margin-bottom: 8px;
      }

      .contact-link {
        font-family: var(--font-head);
        font-size: 1.3rem;
        color: #fff;
        font-weight: 500;
      }

      .contact-link:hover { text-decoration: underline; }

      .footer__bottom {
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        padding-top: 24px;
      }

      .footer__copy {
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.6);
      }

      /* Focus states */
      :focus-visible {
        outline: 2px solid rgba(239,126,161,0.7);
        outline-offset: 2px;
      }

      /* Mono override */
      :root {
        --green: #111111;
        --green2: #111111;
        --cream: #111111;
        --coral: #111111;
        --ink: #111111;
        --line: rgba(0, 0, 0, 0.12);
        --shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
      }

      body {
        background: #ffffff;
        color: #111111;
      }

      body::before,
      body::after {
        display: none;
      }

      h1,
      h2,
      h3,
      h4 {
        color: #111111;
      }

      .hero__p,
      .muted,
      .timestamp,
      .list__meta,
      .weather__summary,
      .manifesto__meta {
        color: #555555;
      }

      .eyebrow {
        color: #555555;
      }

      .header {
        background: rgba(30, 27, 24, 0.92);
        border-bottom: 1px solid rgba(255, 255, 255, 0.04);
      }

      .header--scrolled {
        background: rgba(30, 27, 24, 0.98);
        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      }

      .logo {
        color: #f6f2ec;
      }

      .nav a {
        color: rgba(246, 242, 236, 0.76);
      }

      .nav a:hover,
      .nav a.is-active {
        color: #ffffff;
      }

      .lang {
        border: 1px solid rgba(246, 242, 236, 0.28);
        background: rgba(246, 242, 236, 0.12);
      }

      .lang__btn {
        color: rgba(246, 242, 236, 0.78);
      }

      .lang__btn.is-active {
        color: #ffffff;
      }

      .search {
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.2);
      }

      .search input {
        color: #111111;
      }

      .search input::placeholder {
        color: #888888;
      }

      .weather__form input,
      .token-row input {
        background: #ffffff;
        border-color: #e0e0e0;
        color: #111111;
      }

      .btn--light,
      .btn--white {
        background: #111111;
        color: #ffffff;
        border-color: #111111;
      }

      .btn--outline {
        color: #111111;
        border-color: #111111;
        background: transparent;
      }

      .btn--ghost {
        color: #111111;
        border-color: rgba(0, 0, 0, 0.2);
        background: #ffffff;
      }

      .card {
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.12);
        box-shadow: none;
      }

      .icon-circle {
        background: #111111;
        border-color: #111111;
        color: #ffffff;
      }

      .tag,
      .chip {
        background: #f2f2f2;
        border-color: #e0e0e0;
        color: #111111;
      }

      .chip.is-active {
        background: #111111;
        border-color: #111111;
        color: #ffffff;
      }

      .kebab {
        color: #111111;
      }

      .kebab:hover {
        background: #f2f2f2;
        border-color: #e0e0e0;
      }

      .list__item {
        background: #f7f7f7;
        border-color: #e0e0e0;
      }

      .rank {
        background: #ffffff;
        border: 1px solid #e0e0e0;
        color: #111111;
      }

      .list__title {
        color: #111111;
      }

      .list__link {
        color: #111111;
      }

      .list__link:hover {
        color: #000000;
      }

      .list__empty {
        border-color: #e0e0e0;
        color: #555555;
      }

      .skeleton__bar {
        background: #eeeeee;
      }

      .skeleton__bar::after {
        background: linear-gradient(90deg, transparent, rgba(0, 0, 0, 0.06), transparent);
      }

      .error {
        background: #ffffff;
        border-color: #e0e0e0;
        color: #111111;
      }

      .kpi-pill {
        background: #f7f7f7;
        border-color: #e0e0e0;
        color: #111111;
      }

      .delta.up {
        color: #111111;
      }

      .delta.down {
        color: #666666;
      }

      .status-pill {
        background: #111111;
        border-color: #111111;
        color: #ffffff;
      }

      .meter__track {
        background: #e0e0e0;
      }

      .meter__fill {
        background: #111111;
      }

      .meter__labels {
        color: #111111;
      }

      .stat {
        color: #555555;
      }

      .stat__value {
        color: #111111;
      }

      .manifesto__line {
        color: #111111;
      }

      .footer {
        background: #111111;
      }

      .footer__text,
      .footer__copy,
      .contact-label {
        color: rgba(255, 255, 255, 0.7);
      }

      .contact-link {
        color: #ffffff;
      }

      :focus-visible {
        outline: 2px solid #111111;
      }

      .header :focus-visible {
        outline: 2px solid #ffffff;
      }
    </style>
  </head>
  <body class="case-page">
    <header class="header">
      <div class="container header__inner">
        <a class="logo" href="index.html#top" data-i18n="logo_text">A.U. Portfolio</a>
        <nav class="nav">
          <a href="index.html#about" data-i18n="nav_about">Om mig</a>
          <a href="index.html#cases" data-i18n="nav_cases">Utvalda projekt</a>
          <a href="index.html#skills" data-i18n="nav_skills">Färdigheter</a>
          <a href="index.html#contact" data-i18n="nav_contact">Kontakt</a>
        </nav>
        <div class="lang" aria-label="Language toggle">
          <button class="lang__btn is-active" type="button" data-lang="sv">SV</button>
          <button class="lang__btn" type="button" data-lang="en">EN</button>
        </div>
      </div>
    </header>

    <main id="top">
      <section class="section-block radar">
        <div class="container">
          <a href="index.html#mini" class="back-link" data-i18n="back_to_mini">← Tillbaka till små projekt</a>
          <div class="radar__hero">
            <div>
              <h1 class="h-display" data-i18n="page_title">Ava Growth Radar</h1>
              <p class="eyebrow" data-i18n="growth_signals_api">Growth Signals API</p>
              <p class="hero__p" data-i18n="hero_desc">
                Live signals for growth teams. Track what is spiking, what is shifting, and where demand is forming.
              </p>
            </div>
            <div class="radar__controls">
              <div class="timestamp"><span data-i18n="updated_label">Updated</span> <span id="updatedAt">--</span></div>
              <div class="controls-row">
                <button
                  class="btn btn--light"
                  id="refreshBtn"
                  type="button"
                  aria-label="Refresh data"
                  data-i18n="refresh"
                  data-i18n-aria="refresh_aria"
                >
                  Refresh
                </button>
                <div class="search">
                  <label class="sr-only" for="searchInput" data-i18n="search_label">Search signals</label>
                  <input
                    id="searchInput"
                    type="search"
                    placeholder="Search signals..."
                    autocomplete="off"
                    data-i18n-placeholder="search_placeholder"
                  />
                </div>
              </div>
            </div>
          </div>

          <div class="dashboard">
            <article class="card card--viral" aria-live="polite">
              <div class="card__header">
                <div class="card__heading">
                  <span class="icon-circle" aria-hidden="true">V</span>
                  <div>
                    <h2 data-i18n="viral_title">Viral just nu</h2>
                    <span class="tag" data-i18n="viral_tag">Wikimedia</span>
                  </div>
                </div>
                <div class="card__actions">
                  <div class="chip-group" id="viralToggle" role="tablist" aria-label="Viral region">
                    <button class="chip is-active" type="button" data-project="sv.wikipedia" aria-pressed="true">SE</button>
                    <button
                      class="chip"
                      type="button"
                      data-project="en.wikipedia"
                      aria-pressed="false"
                      data-i18n="global_label"
                    >
                      Global
                    </button>
                  </div>
                  <button class="kebab" type="button" aria-label="More options" data-i18n-aria="more_options">...</button>
                </div>
              </div>
              <div class="card__body">
                <ul class="list" id="viralList"></ul>
              </div>
            </article>

            <article class="card card--buzz" aria-live="polite">
              <div class="card__header">
                <div class="card__heading">
                  <span class="icon-circle" aria-hidden="true">B</span>
                  <div>
                    <h2 data-i18n="buzz_title">Buzz</h2>
                    <span class="tag" data-i18n="buzz_tag">HN / AI / Ads</span>
                  </div>
                </div>
                <div class="card__actions">
                  <button class="kebab" type="button" aria-label="More options" data-i18n-aria="more_options">...</button>
                </div>
              </div>
              <div class="card__body">
                <div class="muted" id="buzzNote" style="margin-bottom: 10px;"></div>
                <ul class="list" id="buzzList"></ul>
              </div>
            </article>

            <article class="card card--pulse" aria-live="polite">
              <div class="card__header">
                <div class="card__heading">
                  <span class="icon-circle" aria-hidden="true">P</span>
                  <div>
                    <h2 data-i18n="pulse_title">Platform Pulse</h2>
                    <span class="tag" data-i18n="pulse_tag">GDELT</span>
                  </div>
                </div>
                <div class="card__actions">
                  <div class="chip-group" id="pulseQueryToggle" role="tablist" aria-label="Platform query">
                    <button class="chip is-active" type="button" data-query="google" aria-pressed="true">Google</button>
                    <button class="chip" type="button" data-query="meta" aria-pressed="false">Meta</button>
                  </div>
                  <div class="chip-group" id="pulseTimespanToggle" role="tablist" aria-label="Timespan">
                    <button class="chip is-active" type="button" data-timespan="7d" aria-pressed="true">7d</button>
                    <button class="chip" type="button" data-timespan="30d" aria-pressed="false">30d</button>
                  </div>
                  <button class="kebab" type="button" aria-label="More options" data-i18n-aria="more_options">...</button>
                </div>
              </div>
              <div class="card__body">
                <ul class="list" id="pulseList"></ul>
              </div>
            </article>

            <article class="card card--fx" aria-live="polite">
              <div class="card__header">
                <div class="card__heading">
                  <span class="icon-circle" aria-hidden="true">FX</span>
                  <div>
                    <h2 data-i18n="fx_title">FX / Margin Watch</h2>
                    <span class="tag" data-i18n="fx_tag">Frankfurter</span>
                  </div>
                </div>
                <div class="card__actions">
                  <button class="kebab" type="button" aria-label="More options" data-i18n-aria="more_options">...</button>
                </div>
              </div>
              <div class="card__body">
                <div id="fxRates" class="kpi-grid"></div>
              </div>
            </article>

            <article class="card card--weather" aria-live="polite">
              <div class="card__header">
                <div class="card__heading">
                  <span class="icon-circle" aria-hidden="true">WX</span>
                  <div>
                    <h2 data-i18n="weather_title">Weather Trigger</h2>
                    <span class="tag" data-i18n="weather_tag">Open-Meteo</span>
                  </div>
                </div>
                <div class="card__actions">
                  <button class="kebab" type="button" aria-label="More options" data-i18n-aria="more_options">...</button>
                </div>
              </div>
              <div class="card__body">
                <form class="weather__form" id="weatherForm">
                  <label class="sr-only" for="weatherCity" data-i18n="weather_label">City</label>
                  <input
                    id="weatherCity"
                    type="text"
                    value="Stockholm"
                    placeholder="City (Stockholm)"
                    data-i18n-placeholder="weather_placeholder"
                  />
                  <button
                    class="btn btn--ghost btn--small"
                    type="submit"
                    aria-label="Set city"
                    data-i18n="weather_set"
                    data-i18n-aria="weather_set_aria"
                  >
                    Set
                  </button>
                </form>
                <span class="status-pill" id="weatherTrigger" data-i18n="loading">Laddar...</span>
                <div class="weather__summary" id="weatherSummary"></div>
              </div>
            </article>

            <article class="card card--pinterest" aria-live="polite">
              <div class="card__header">
                <div class="card__heading">
                  <span class="icon-circle" aria-hidden="true">PT</span>
                  <div>
                    <h2 data-i18n="pinterest_title">Pinterest Trendspaning</h2>
                    <span class="tag" data-i18n="pinterest_tag">REST API v5.23</span>
                  </div>
                </div>
                <div class="card__actions">
                  <button class="kebab" type="button" aria-label="More options" data-i18n-aria="more_options">...</button>
                </div>
              </div>
              <div class="card__body">
                <p class="muted" data-i18n="pinterest_desc">Trendspaning via Pinterest Trends API.</p>
                <div class="chip-group chip-group--static" data-i18n-aria="pinterest_capabilities">
                  <span class="chip chip--static" data-i18n="pinterest_feature_conversion">Conversion</span>
                  <span class="chip chip--static" data-i18n="pinterest_feature_content">Content</span>
                  <span class="chip chip--static" data-i18n="pinterest_feature_ads">Ads</span>
                  <span class="chip chip--static" data-i18n="pinterest_feature_targeting">Targeting</span>
                  <span class="chip chip--static" data-i18n="pinterest_feature_shopping">Shopping</span>
                  <span class="chip chip--static" data-i18n="pinterest_feature_analytics">Analytics</span>
                </div>
                <div class="chip-group" id="pinterestRegionToggle" role="tablist" data-i18n-aria="pinterest_region_label">
                  <button class="chip is-active" type="button" data-region="SE+DK+FI+NO" aria-pressed="true" data-i18n="pinterest_region_nordic">Nordic</button>
                  <button class="chip" type="button" data-region="US" aria-pressed="false" data-i18n="pinterest_region_us">US</button>
                </div>
                <div class="chip-group" id="pinterestTrendToggle" role="tablist" data-i18n-aria="pinterest_trend_label">
                  <button class="chip is-active" type="button" data-trend="growing" aria-pressed="true" data-i18n="pinterest_trend_growing">Growing</button>
                  <button class="chip" type="button" data-trend="monthly" aria-pressed="false" data-i18n="pinterest_trend_monthly">Monthly</button>
                  <button class="chip" type="button" data-trend="yearly" aria-pressed="false" data-i18n="pinterest_trend_yearly">Yearly</button>
                  <button class="chip" type="button" data-trend="seasonal" aria-pressed="false" data-i18n="pinterest_trend_seasonal">Seasonal</button>
                </div>
                <div class="token-row">
                  <label class="sr-only" for="pinterestToken" data-i18n="pinterest_token_label">Pinterest access token</label>
                  <input
                    id="pinterestToken"
                    type="password"
                    autocomplete="off"
                    placeholder="Pinterest access token"
                    data-i18n-placeholder="pinterest_token_placeholder"
                  />
                  <button
                    class="btn btn--ghost btn--small"
                    id="pinterestSave"
                    type="button"
                    aria-label="Save Pinterest token"
                    data-i18n="pinterest_save"
                    data-i18n-aria="pinterest_save_aria"
                  >
                    Spara
                  </button>
                </div>
                <div class="muted" id="pinterestNote" style="margin-bottom: 10px;"></div>
                <ul class="list" id="pinterestList"></ul>
              </div>
            </article>

          </div>
        </div>
      </section>

      <footer id="contact" class="footer section-block">
        <div class="container footer__grid">
          <div class="footer__left">
            <h2 data-i18n="contact_title">Kontakt</h2>
            <p class="footer__text" data-i18n="footer_text">
              Nyfiken på att veta mer eller diskutera ett projekt?
              Hör av dig så tar vi en kaffe!
            </p>
            <a href="./cv/ava-urden-cv-sv.pdf" download class="btn btn--white" data-i18n="cta_cv">Ladda ner CV</a>
          </div>

          <div class="footer__right">
            <div class="contact-group">
              <span class="contact-label" data-i18n="contact_email">Email</span>
              <a href="mailto:ava.urden@gmail.com" class="contact-link email-link">ava.urden@gmail.com</a>
            </div>
            <div class="contact-group">
              <span class="contact-label" data-i18n="contact_mobile">Mobil</span>
              <a href="tel:+46723111441" class="contact-link">+46 72 311 14 41</a>
            </div>
            <div class="contact-group">
              <span class="contact-label" data-i18n="contact_linkedin">LinkedIn</span>
              <a href="https://linkedin.com/in/avaurden" target="_blank" rel="noopener" class="contact-link">
                linkedin.com/in/avaurden
              </a>
            </div>
          </div>
        </div>
        <div class="container footer__bottom">
          <div class="footer__copy">&copy; 2026 Ava Urdén</div>
        </div>
      </footer>
    </main>

    <script>
      const state = {
        viralProject: "sv.wikipedia",
        pulseQuery: "google",
        pulseTimespan: "7d",
        pinterestRegion: "SE+DK+FI+NO",
        pinterestTrendType: "growing",
        searchTerm: "",
        viral: [],
        buzz: [],
        pulse: [],
        pinterest: [],
        buzzMatches: 0,
        viralTopViews: 0,
        weatherData: null,
        lang: "sv",
        loaded: {
          viral: false,
          buzz: false,
          pulse: false,
          pinterest: false
        }
      };

      const langDict = {
        sv: {
          logo_text: "A.U. Portfolio",
          nav_about: "Om mig",
          nav_cases: "Utvalda projekt",
          nav_skills: "Färdigheter",
          nav_contact: "Kontakt",
          back_to_mini: "← Tillbaka till små projekt",
          page_title: "Ava Growth Radar",
          growth_signals_api: "Growth Signals API",
          hero_desc: "Live-signaler för growth-team. Se vad som spikar, vad som skiftar och var efterfrågan byggs.",
          updated_label: "Uppdaterad",
          refresh: "Uppdatera",
          refresh_aria: "Uppdatera data",
          search_label: "Sök signaler",
          search_placeholder: "Sök signaler...",
          viral_title: "Viral just nu",
          viral_tag: "Wikimedia",
          global_label: "Global",
          buzz_title: "Buzz",
          buzz_tag: "HN / AI / Ads",
          pulse_title: "Platform Pulse",
          pulse_tag: "GDELT",
          fx_title: "FX / Marginalkoll",
          fx_tag: "Frankfurter",
          weather_title: "Vädertrigger",
          weather_tag: "Open-Meteo",
          weather_label: "Stad",
          weather_placeholder: "Stad (Stockholm)",
          weather_set: "Sätt",
          weather_set_aria: "Sätt stad",
          more_options: "Fler alternativ",
          open: "Öppna",
          trend_label: "Trend",
          no_matches: "Inga träffar.",
          views: "visningar",
          points: "poäng",
          loading: "Laddar...",
          open_source: "Open source",
          error_wikimedia: "Kunde inte hämta Wikimedia just nu.",
          error_hn: "Kunde inte hämta HN just nu.",
          error_gdelt: "Kunde inte hämta GDELT just nu.",
          error_fx: "Kunde inte hämta FX-kurser just nu.",
          error_weather: "Kunde inte hämta väder just nu.",
          error_pinterest: "Kunde inte hämta Pinterest-trender just nu.",
          buzz_no_matches: "Inga träffar på nyckelord idag.",
          weather_unavailable: "Otillgängligt",
          weather_summary: "{city}: {temp}°C, moln {cloud}%, regn {precip}%",
          weather_sunny: "Soligt fönster",
          weather_rain: "Regnläge",
          weather_cloud: "Molnläge",
          weather_mild: "Lugn nivå",
          pinterest_title: "Pinterest Trendspaning",
          pinterest_tag: "REST API v5.23",
          pinterest_desc: "Trendspaning via Pinterest Trends API.",
          pinterest_capabilities: "Pinterest API-områden",
          pinterest_feature_conversion: "Konvertering",
          pinterest_feature_content: "Innehåll",
          pinterest_feature_ads: "Annonser",
          pinterest_feature_targeting: "Målgrupper",
          pinterest_feature_shopping: "Shopping",
          pinterest_feature_analytics: "Analys",
          pinterest_region_label: "Region",
          pinterest_region_nordic: "Norden",
          pinterest_region_us: "USA",
          pinterest_trend_label: "Trendtyp",
          pinterest_trend_growing: "Växande",
          pinterest_trend_monthly: "Månad",
          pinterest_trend_yearly: "År",
          pinterest_trend_seasonal: "Säsong",
          pinterest_token_label: "Pinterest access token",
          pinterest_token_placeholder: "Pinterest access token",
          pinterest_save: "Spara",
          pinterest_save_aria: "Spara Pinterest-token",
          pinterest_need_token: "Lägg in en access token för att hämta trendord.",
          pinterest_empty: "Ingen Pinterest-data ännu.",
          growth_wow: "WoW",
          growth_mom: "MoM",
          growth_yoy: "YoY",
          growth_unavailable: "Ingen tillväxtdata",
          contact_title: "Kontakt",
          footer_text:
            "Nyfiken på att veta mer eller diskutera ett projekt? Hör av dig så tar vi en kaffe!",
          cta_cv: "Ladda ner CV",
          contact_email: "Email",
          contact_mobile: "Mobil",
          contact_linkedin: "LinkedIn"
        },
        en: {
          logo_text: "A.U. Portfolio",
          nav_about: "About",
          nav_cases: "Selected work",
          nav_skills: "Skills",
          nav_contact: "Contact",
          back_to_mini: "← Back to mini projects",
          page_title: "Ava Growth Radar",
          growth_signals_api: "Growth Signals API",
          hero_desc: "Live signals for growth teams. Track what is spiking, what is shifting, and where demand is forming.",
          updated_label: "Updated",
          refresh: "Refresh",
          refresh_aria: "Refresh data",
          search_label: "Search signals",
          search_placeholder: "Search signals...",
          viral_title: "Viral now",
          viral_tag: "Wikimedia",
          global_label: "Global",
          buzz_title: "Buzz",
          buzz_tag: "HN / AI / Ads",
          pulse_title: "Platform Pulse",
          pulse_tag: "GDELT",
          fx_title: "FX / Margin Watch",
          fx_tag: "Frankfurter",
          weather_title: "Weather Trigger",
          weather_tag: "Open-Meteo",
          weather_label: "City",
          weather_placeholder: "City (Stockholm)",
          weather_set: "Set",
          weather_set_aria: "Set city",
          more_options: "More options",
          open: "Open",
          trend_label: "Trend",
          no_matches: "No matches.",
          views: "views",
          points: "points",
          loading: "Loading...",
          open_source: "Open source",
          error_wikimedia: "Could not load Wikimedia right now.",
          error_hn: "Could not load HN right now.",
          error_gdelt: "Could not load GDELT right now.",
          error_fx: "Could not load FX rates right now.",
          error_weather: "Could not load weather right now.",
          error_pinterest: "Could not load Pinterest trends right now.",
          buzz_no_matches: "No keyword matches today.",
          weather_unavailable: "Unavailable",
          weather_summary: "{city}: {temp}°C, clouds {cloud}%, precip {precip}%",
          weather_sunny: "Sunny window",
          weather_rain: "Rain push",
          weather_cloud: "Cloud watch",
          weather_mild: "Mild watch",
          pinterest_title: "Pinterest Trend Watch",
          pinterest_tag: "REST API v5.23",
          pinterest_desc: "Trend watch via the Pinterest Trends API.",
          pinterest_capabilities: "Pinterest API areas",
          pinterest_feature_conversion: "Conversion",
          pinterest_feature_content: "Content",
          pinterest_feature_ads: "Ads",
          pinterest_feature_targeting: "Targeting",
          pinterest_feature_shopping: "Shopping",
          pinterest_feature_analytics: "Analytics",
          pinterest_region_label: "Region",
          pinterest_region_nordic: "Nordic",
          pinterest_region_us: "US",
          pinterest_trend_label: "Trend type",
          pinterest_trend_growing: "Growing",
          pinterest_trend_monthly: "Monthly",
          pinterest_trend_yearly: "Yearly",
          pinterest_trend_seasonal: "Seasonal",
          pinterest_token_label: "Pinterest access token",
          pinterest_token_placeholder: "Pinterest access token",
          pinterest_save: "Save",
          pinterest_save_aria: "Save Pinterest token",
          pinterest_need_token: "Add an access token to fetch trend keywords.",
          pinterest_empty: "No Pinterest data yet.",
          growth_wow: "WoW",
          growth_mom: "MoM",
          growth_yoy: "YoY",
          growth_unavailable: "Growth data unavailable",
          contact_title: "Contact",
          footer_text: "Curious to learn more or discuss a project? Reach out and let’s grab a coffee.",
          cta_cv: "Download CV",
          contact_email: "Email",
          contact_mobile: "Phone",
          contact_linkedin: "LinkedIn"
        }
      };

      const CACHE_TTL = 15 * 60 * 1000;
      const KEYWORDS = [
        "ads",
        "marketing",
        "ecommerce",
        "seo",
        "google",
        "meta",
        "ai",
        "gemini",
        "overviews",
        "pmax",
        "performance max"
      ];

      const PULSE_QUERIES = {
        google: '("AI Overviews" OR "AI Mode" OR "core update" OR "Search Central") AND (Google OR "Search Console")',
        meta: '("Marketing API" OR "Advantage+" OR "Ads Manager" OR "Meta ads") AND (Meta OR Facebook OR Instagram)'
      };

      const PINTEREST_BASE = "https://api.pinterest.com/v5";
      const PINTEREST_DOCS = "https://developers.pinterest.com/docs/api/v5/";
      const PINTEREST_TOKEN_KEY = "growthRadar:pinterestToken";

      const defaultCity = {
        name: "Stockholm",
        latitude: 59.3293,
        longitude: 18.0686
      };

      const elements = {
        updatedAt: document.getElementById("updatedAt"),
        refreshBtn: document.getElementById("refreshBtn"),
        searchInput: document.getElementById("searchInput"),
        viralList: document.getElementById("viralList"),
        buzzList: document.getElementById("buzzList"),
        buzzNote: document.getElementById("buzzNote"),
        pulseList: document.getElementById("pulseList"),
        fxRates: document.getElementById("fxRates"),
        weatherForm: document.getElementById("weatherForm"),
        weatherCity: document.getElementById("weatherCity"),
        weatherTrigger: document.getElementById("weatherTrigger"),
        weatherSummary: document.getElementById("weatherSummary"),
        pinterestList: document.getElementById("pinterestList"),
        pinterestNote: document.getElementById("pinterestNote"),
        pinterestToken: document.getElementById("pinterestToken"),
        pinterestSave: document.getElementById("pinterestSave")
      };

      function t(key) {
        const dict = langDict[state.lang] || langDict.sv;
        return dict[key] || langDict.sv[key] || "";
      }

      function formatTemplate(str, vars) {
        return str.replace(/\{(\w+)\}/g, (match, key) => (key in vars ? vars[key] : match));
      }

      function applyLang(lang) {
        const dict = langDict[lang] || langDict.sv;
        state.lang = lang;
        document.documentElement.lang = lang;
        document.querySelectorAll("[data-i18n]").forEach((el) => {
          const key = el.dataset.i18n;
          if (dict[key]) el.textContent = dict[key];
        });
        document.querySelectorAll("[data-i18n-placeholder]").forEach((el) => {
          const key = el.dataset.i18nPlaceholder;
          if (dict[key]) el.setAttribute("placeholder", dict[key]);
        });
        document.querySelectorAll("[data-i18n-aria]").forEach((el) => {
          const key = el.dataset.i18nAria;
          if (dict[key]) el.setAttribute("aria-label", dict[key]);
        });
        document.querySelectorAll(".lang__btn").forEach((btn) => {
          btn.classList.toggle("is-active", btn.dataset.lang === lang);
        });
        localStorage.setItem("lang", lang);
        updateTimestamp();
        renderViral();
        renderBuzz();
        renderPulse();
        renderPinterest();
        if (!getPinterestToken()) {
          elements.pinterestNote.textContent = t("pinterest_need_token");
        }
        if (state.weatherData) {
          renderWeather(state.weatherData);
        }
      }

      function updateTimestamp() {
        const now = new Date();
        const locale = state.lang === "en" ? "en-US" : "sv-SE";
        const formatted = now.toLocaleString(locale, {
          year: "numeric",
          month: "short",
          day: "numeric",
          hour: "2-digit",
          minute: "2-digit"
        });
        elements.updatedAt.textContent = formatted;
      }

      function escapeHTML(str = "") {
        return str.replace(/[&<>"']/g, (match) => {
          const map = {
            "&": "&amp;",
            "<": "&lt;",
            ">": "&gt;",
            "\"": "&quot;",
            "'": "&#39;"
          };
          return map[match] || match;
        });
      }

      function formatNumber(value) {
        if (value === undefined || value === null) return "--";
        return new Intl.NumberFormat("sv-SE").format(value);
      }

      function formatPercent(value) {
        if (value === undefined || value === null || Number.isNaN(value)) return "--";
        const sign = value > 0 ? "+" : "";
        return `${sign}${value.toFixed(2)}%`;
      }

      function cacheGet(key, ttl, force) {
        if (force) return null;
        const raw = localStorage.getItem(key);
        if (!raw) return null;
        try {
          const payload = JSON.parse(raw);
          if (Date.now() - payload.ts < ttl) return payload.data;
        } catch (err) {
          return null;
        }
        return null;
      }

      function cacheSet(key, data) {
        localStorage.setItem(key, JSON.stringify({ ts: Date.now(), data }));
      }

      async function fetchJson(url, { cacheKey, ttl = CACHE_TTL, force = false, headers } = {}) {
        if (cacheKey) {
          const cached = cacheGet(cacheKey, ttl, force);
          if (cached) return cached;
        }
        const response = await fetch(url, { headers });
        if (!response.ok) {
          const error = new Error(`HTTP ${response.status}`);
          error.status = response.status;
          throw error;
        }
        const data = await response.json();
        if (cacheKey) cacheSet(cacheKey, data);
        return data;
      }

      function renderSkeleton(listEl, count = 6) {
        listEl.innerHTML = Array.from({ length: count })
          .map(() => `<li class="list__item skeleton"><div class="skeleton__bar"></div></li>`)
          .join("");
      }

      function renderError(container, message, link, asList = false) {
        const linkHtml = link
          ? ` <a href="${link}" target="_blank" rel="noopener">${t("open_source")}</a>`
          : "";
        const body = `<div class="error">${escapeHTML(message)}${linkHtml}</div>`;
        container.innerHTML = asList ? `<li class="list__empty">${body}</li>` : body;
      }

      function filterBySearch(items) {
        const query = state.searchTerm.trim().toLowerCase();
        if (!query) return items;
        return items.filter((item) => item.title.toLowerCase().includes(query));
      }

      function getUtcYesterday() {
        const now = new Date();
        const utc = new Date(Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate()));
        const yesterday = new Date(utc.getTime() - 24 * 60 * 60 * 1000);
        const year = yesterday.getUTCFullYear();
        const month = String(yesterday.getUTCMonth() + 1).padStart(2, "0");
        const day = String(yesterday.getUTCDate()).padStart(2, "0");
        return { year, month, day };
      }

      function decodeTitle(title = "") {
        return decodeURIComponent(title.replace(/_/g, " "));
      }

      function getPinterestToken() {
        return localStorage.getItem(PINTEREST_TOKEN_KEY) || "";
      }

      function getPinterestGrowthMeta(item) {
        let value = null;
        let suffix = "";
        if (state.pinterestTrendType === "growing" || state.pinterestTrendType === "seasonal") {
          value = item.pct_growth_wow;
          suffix = t("growth_wow");
        } else if (state.pinterestTrendType === "monthly") {
          value = item.pct_growth_mom;
          suffix = t("growth_mom");
        } else if (state.pinterestTrendType === "yearly") {
          value = item.pct_growth_yoy;
          suffix = t("growth_yoy");
        }
        if (typeof value !== "number") return t("growth_unavailable");
        return `${formatPercent(value)} ${suffix}`;
      }

      function renderViral() {
        if (!state.loaded.viral) return;
        const list = filterBySearch(state.viral);
        if (!list.length) {
          elements.viralList.innerHTML = `<li class="list__empty">${t("no_matches")}</li>`;
          return;
        }
        elements.viralList.innerHTML = list
          .map((item) => {
            return `
              <li class="list__item">
                <span class="rank">${String(item.rank).padStart(2, "0")}</span>
                <div class="list__text">
                  <span class="list__title">${escapeHTML(item.title)}</span>
                  <span class="list__meta">${formatNumber(item.views)} ${t("views")}</span>
                </div>
                <a class="list__link" href="${item.url}" target="_blank" rel="noopener" aria-label="${t("open")} ${escapeHTML(item.title)}">${t("open")}</a>
              </li>
            `;
          })
          .join("");
      }

      function renderBuzz() {
        if (!state.loaded.buzz) return;
        elements.buzzNote.textContent = state.buzzMatches ? "" : t("buzz_no_matches");
        const list = filterBySearch(state.buzz);
        if (!list.length) {
          elements.buzzList.innerHTML = `<li class="list__empty">${t("no_matches")}</li>`;
          return;
        }
        elements.buzzList.innerHTML = list
          .map((item, index) => {
            return `
              <li class="list__item">
                <span class="rank">${String(index + 1).padStart(2, "0")}</span>
                <div class="list__text">
                  <span class="list__title">${escapeHTML(item.title)}</span>
                  <span class="list__meta">${formatNumber(item.points)} ${t("points")}</span>
                </div>
                <a class="list__link" href="${item.url}" target="_blank" rel="noopener" aria-label="${t("open")} ${escapeHTML(item.title)}">${t("open")}</a>
              </li>
            `;
          })
          .join("");
      }

      function renderPulse() {
        if (!state.loaded.pulse) return;
        const list = filterBySearch(state.pulse);
        if (!list.length) {
          elements.pulseList.innerHTML = `<li class="list__empty">${t("no_matches")}</li>`;
          return;
        }
        elements.pulseList.innerHTML = list
          .map((item, index) => {
            return `
              <li class="list__item">
                <span class="rank">${String(index + 1).padStart(2, "0")}</span>
                <div class="list__text">
                  <span class="list__title">${escapeHTML(item.title)}</span>
                  <span class="list__meta">${escapeHTML(item.source)} • ${escapeHTML(item.date)}</span>
                </div>
                <a class="list__link" href="${item.url}" target="_blank" rel="noopener" aria-label="${t("open")} ${escapeHTML(item.title)}">${t("open")}</a>
              </li>
            `;
          })
          .join("");
      }

      function renderPinterest() {
        if (!state.loaded.pinterest) return;
        const token = getPinterestToken();
        if (!token) {
          elements.pinterestList.innerHTML = `<li class="list__empty">${t("pinterest_empty")}</li>`;
          return;
        }
        const list = filterBySearch(state.pinterest);
        if (!list.length) {
          elements.pinterestList.innerHTML = `<li class="list__empty">${t("no_matches")}</li>`;
          return;
        }
        elements.pinterestList.innerHTML = list
          .map((item, index) => {
            return `
              <li class="list__item">
                <span class="rank">${String(index + 1).padStart(2, "0")}</span>
                <div class="list__text">
                  <span class="list__title">${escapeHTML(item.title)}</span>
                  <span class="list__meta">${escapeHTML(item.meta)}</span>
                </div>
                <span class="list__link">${t("trend_label")}</span>
              </li>
            `;
          })
          .join("");
      }


      async function loadViral(force = false) {
        renderSkeleton(elements.viralList, 8);
        const { year, month, day } = getUtcYesterday();
        const project = state.viralProject;
        const url = `https://wikimedia.org/api/rest_v1/metrics/pageviews/top/${project}/all-access/${year}/${month}/${day}`;
        const cacheKey = `growthRadar:viral:${project}:${year}-${month}-${day}`;
        const base = project === "sv.wikipedia" ? "https://sv.wikipedia.org/wiki/" : "https://en.wikipedia.org/wiki/";
        try {
          const data = await fetchJson(url, { cacheKey, force });
          const items = data?.items?.[0]?.articles || [];
          const blockedPrefixes = [
            "special:",
            "portal:",
            "wikipedia:",
            "kategori:",
            "category:",
            "file:",
            "fil:",
            "template:",
            "mall:",
            "help:",
            "user:",
            "draft:",
            "talk:",
            "diskussion:"
          ];
          const cleaned = items
            .map((item) => ({ ...item, title: decodeTitle(item.article) }))
            .filter((item) => {
              const lower = item.title.toLowerCase();
              return !blockedPrefixes.some((prefix) => lower.startsWith(prefix));
            });
          const top = cleaned.slice(0, 8).map((item, index) => ({
            rank: index + 1,
            title: item.title,
            views: item.views,
            url: `${base}${encodeURIComponent(item.article)}`
          }));
          state.viral = top;
          state.viralTopViews = top[0]?.views || 0;
          state.loaded.viral = true;
          renderViral();
        } catch (err) {
          state.loaded.viral = true;
          renderError(elements.viralList, t("error_wikimedia"), url, true);
        }
      }

      async function loadBuzz(force = false) {
        renderSkeleton(elements.buzzList, 8);
        elements.buzzNote.textContent = "";
        const url = "https://hn.algolia.com/api/v1/search?tags=front_page";
        const cacheKey = "growthRadar:buzz";
        try {
          const data = await fetchJson(url, { cacheKey, force });
          const hits = data?.hits || [];
          const matches = hits.filter((hit) =>
            KEYWORDS.some((keyword) => hit.title && hit.title.toLowerCase().includes(keyword))
          );
          const selected = matches.slice(0, 8);
          state.buzzMatches = selected.length;
          state.buzz = selected.map((hit) => ({
            title: hit.title || "Untitled",
            points: hit.points || 0,
            url: hit.url || `https://news.ycombinator.com/item?id=${hit.objectID}`
          }));
          state.loaded.buzz = true;
          if (!matches.length) elements.buzzNote.textContent = t("buzz_no_matches");
          renderBuzz();
        } catch (err) {
          state.loaded.buzz = true;
          renderError(elements.buzzList, t("error_hn"), url, true);
        }
      }

      function formatSeenDate(seen) {
        if (!seen) return "Unknown date";
        const digits = seen.replace(/\D/g, "");
        if (digits.length >= 8) {
          const y = digits.slice(0, 4);
          const m = digits.slice(4, 6);
          const d = digits.slice(6, 8);
          return `${y}-${m}-${d}`;
        }
        return seen;
      }

      function getSourceName(article) {
        if (article.sourceCommonName) return article.sourceCommonName;
        if (article.sourceCountry) return article.sourceCountry;
        if (article.url) {
          try {
            const host = new URL(article.url).hostname.replace("www.", "");
            return host;
          } catch (err) {
            return "Source";
          }
        }
        return "Source";
      }

      async function loadPulse(force = false) {
        renderSkeleton(elements.pulseList, 8);
        const query = encodeURIComponent(PULSE_QUERIES[state.pulseQuery]);
        const timespan = state.pulseTimespan;
        const url = `https://api.gdeltproject.org/api/v2/doc/doc?query=${query}&mode=ArtList&format=json&maxrecords=8&sort=HybridRel&timelinesmooth=0&timespan=${timespan}`;
        const cacheKey = `growthRadar:pulse:${state.pulseQuery}:${timespan}`;
        try {
          const data = await fetchJson(url, { cacheKey, force });
          const articles = data?.articles || [];
          state.pulse = articles.slice(0, 8).map((article) => ({
            title: article.title || "Untitled",
            url: article.url || "#",
            source: getSourceName(article),
            date: formatSeenDate(article.seendate || article.seenDate || "")
          }));
          state.loaded.pulse = true;
          renderPulse();
        } catch (err) {
          state.loaded.pulse = true;
          renderError(elements.pulseList, t("error_gdelt"), url, true);
        }
      }

      async function loadPinterest(force = false) {
        renderSkeleton(elements.pinterestList, 6);
        elements.pinterestNote.textContent = "";
        const token = getPinterestToken();
        if (!token) {
          state.pinterest = [];
          state.loaded.pinterest = true;
          elements.pinterestNote.textContent = t("pinterest_need_token");
          renderPinterest();
          return;
        }
        const region = encodeURIComponent(state.pinterestRegion);
        const trendType = state.pinterestTrendType;
        const url = `${PINTEREST_BASE}/trends/keywords/${region}/top/${trendType}?limit=10`;
        const cacheKey = `growthRadar:pinterest:${state.pinterestRegion}:${trendType}`;
        try {
          const data = await fetchJson(url, {
            cacheKey,
            force,
            headers: { Authorization: `Bearer ${token}` }
          });
          const trends = data?.trends || [];
          state.pinterest = trends.map((trend) => ({
            title: trend.keyword || "Untitled",
            meta: getPinterestGrowthMeta(trend)
          }));
          state.loaded.pinterest = true;
          renderPinterest();
        } catch (err) {
          state.loaded.pinterest = true;
          if (err?.status === 401 || err?.status === 403) {
            elements.pinterestNote.textContent = t("pinterest_need_token");
          }
          renderError(elements.pinterestList, t("error_pinterest"), PINTEREST_DOCS, true);
        }
      }

      async function loadFx(force = false) {
        elements.fxRates.innerHTML = `<div class="muted">${t("loading")}</div>`;
        const url = "https://api.frankfurter.dev/latest?from=EUR&to=SEK,USD,NOK";
        const cacheKey = "growthRadar:fx:latest";
        try {
          const latest = await fetchJson(url, { cacheKey, force });
          const latestRates = latest?.rates || {};
          const yesterday = new Date();
          yesterday.setUTCDate(yesterday.getUTCDate() - 1);
          const dateStr = `${yesterday.getUTCFullYear()}-${String(yesterday.getUTCMonth() + 1).padStart(2, "0")}-${String(yesterday.getUTCDate()).padStart(2, "0")}`;

          let previousRates = null;
          try {
            const prevUrl = `https://api.frankfurter.dev/${dateStr}?from=EUR&to=SEK,USD,NOK`;
            previousRates = await fetchJson(prevUrl, { cacheKey: `growthRadar:fx:${dateStr}`, force });
          } catch (err) {
            previousRates = null;
          }

          const pairs = [
            { code: "SEK", value: latestRates.SEK, prev: previousRates?.rates?.SEK },
            { code: "USD", value: latestRates.USD, prev: previousRates?.rates?.USD },
            { code: "NOK", value: latestRates.NOK, prev: previousRates?.rates?.NOK }
          ];

          elements.fxRates.innerHTML = pairs
            .map((pair) => {
              const delta =
                pair.prev && pair.value ? ((pair.value - pair.prev) / pair.prev) * 100 : null;
              const deltaClass = delta > 0 ? "delta up" : "delta down";
              const deltaText = delta !== null ? `<span class="${deltaClass}">${formatPercent(delta)}</span>` : "";
              return `
                <div class="kpi-pill">
                  <span>EUR/${pair.code}</span>
                  <span><strong>${pair.value ? pair.value.toFixed(4) : "--"}</strong>${deltaText}</span>
                </div>
              `;
            })
            .join("");
        } catch (err) {
          renderError(elements.fxRates, t("error_fx"), url, false);
        }
      }

      function getWeatherTriggerKey(cloud, precip) {
        if (cloud < 40 && precip < 20) return "sunny";
        if (precip >= 60) return "rain";
        if (cloud >= 70) return "cloud";
        return "mild";
      }

      function renderWeather(data) {
        elements.weatherTrigger.textContent = t(`weather_${data.triggerKey}`);
        elements.weatherSummary.textContent = formatTemplate(t("weather_summary"), {
          city: data.city,
          temp: data.temp ?? "--",
          cloud: data.cloud ?? "--",
          precip: data.precip ?? "--"
        });
      }

      async function resolveCity(city, force = false) {
        if (!city || city.trim().length === 0) return defaultCity;
        const normalized = city.trim().toLowerCase();
        if (normalized === "stockholm") return defaultCity;

        const url = `https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(
          city
        )}&count=1&language=en&format=json`;
        const cacheKey = `growthRadar:geo:${normalized}`;
        const data = await fetchJson(url, { cacheKey, ttl: 24 * 60 * 60 * 1000, force });
        if (!data?.results?.length) throw new Error("City not found");
        const result = data.results[0];
        return {
          name: result.name,
          latitude: result.latitude,
          longitude: result.longitude
        };
      }

      async function loadWeather(force = false) {
        elements.weatherTrigger.textContent = t("loading");
        elements.weatherSummary.textContent = "";
        const city = elements.weatherCity.value || defaultCity.name;

        try {
          const coords = await resolveCity(city, force);
          const url = `https://api.open-meteo.com/v1/forecast?latitude=${coords.latitude}&longitude=${coords.longitude}&current=temperature_2m,precipitation,cloud_cover&daily=precipitation_probability_max&timezone=auto`;
          const cacheKey = `growthRadar:weather:${coords.name.toLowerCase()}`;
          const data = await fetchJson(url, { cacheKey, force });

          const current = data.current || {};
          const daily = data.daily || {};
          const precipProb = Array.isArray(daily.precipitation_probability_max)
            ? daily.precipitation_probability_max[0]
            : 0;

          const triggerKey = getWeatherTriggerKey(current.cloud_cover || 0, precipProb || 0);
          state.weatherData = {
            city: coords.name,
            temp: current.temperature_2m,
            cloud: current.cloud_cover,
            precip: precipProb,
            triggerKey
          };
          renderWeather(state.weatherData);

        } catch (err) {
          renderError(
            elements.weatherSummary,
            t("error_weather"),
            "https://api.open-meteo.com/",
            false
          );
          state.weatherData = null;
          elements.weatherTrigger.textContent = t("weather_unavailable");
        }
      }

      function setToggleActive(group, attr, value) {
        group.querySelectorAll("button").forEach((btn) => {
          const isActive = btn.getAttribute(attr) === value;
          btn.classList.toggle("is-active", isActive);
          btn.setAttribute("aria-pressed", isActive ? "true" : "false");
        });
      }

      function attachEvents() {
        const storedLang = localStorage.getItem("lang") || "sv";
        applyLang(storedLang);

        document.querySelectorAll(".lang__btn").forEach((btn) => {
          btn.addEventListener("click", () => applyLang(btn.dataset.lang));
        });

        const storedPinterestToken = getPinterestToken();
        if (storedPinterestToken) {
          elements.pinterestToken.value = storedPinterestToken;
        }

        const viralToggle = document.getElementById("viralToggle");
        viralToggle.addEventListener("click", (event) => {
          const button = event.target.closest("button[data-project]");
          if (!button) return;
          state.viralProject = button.dataset.project;
          setToggleActive(viralToggle, "data-project", state.viralProject);
          loadViral(true);
        });

        const pulseQueryToggle = document.getElementById("pulseQueryToggle");
        pulseQueryToggle.addEventListener("click", (event) => {
          const button = event.target.closest("button[data-query]");
          if (!button) return;
          state.pulseQuery = button.dataset.query;
          setToggleActive(pulseQueryToggle, "data-query", state.pulseQuery);
          loadPulse(true);
        });

        const pulseTimespanToggle = document.getElementById("pulseTimespanToggle");
        pulseTimespanToggle.addEventListener("click", (event) => {
          const button = event.target.closest("button[data-timespan]");
          if (!button) return;
          state.pulseTimespan = button.dataset.timespan;
          setToggleActive(pulseTimespanToggle, "data-timespan", state.pulseTimespan);
          loadPulse(true);
        });

        const pinterestRegionToggle = document.getElementById("pinterestRegionToggle");
        pinterestRegionToggle.addEventListener("click", (event) => {
          const button = event.target.closest("button[data-region]");
          if (!button) return;
          state.pinterestRegion = button.dataset.region;
          setToggleActive(pinterestRegionToggle, "data-region", state.pinterestRegion);
          loadPinterest(true);
        });

        const pinterestTrendToggle = document.getElementById("pinterestTrendToggle");
        pinterestTrendToggle.addEventListener("click", (event) => {
          const button = event.target.closest("button[data-trend]");
          if (!button) return;
          state.pinterestTrendType = button.dataset.trend;
          setToggleActive(pinterestTrendToggle, "data-trend", state.pinterestTrendType);
          loadPinterest(true);
        });

        elements.pinterestSave.addEventListener("click", () => {
          const token = elements.pinterestToken.value.trim();
          if (token) {
            localStorage.setItem(PINTEREST_TOKEN_KEY, token);
          } else {
            localStorage.removeItem(PINTEREST_TOKEN_KEY);
          }
          loadPinterest(true);
        });

        elements.refreshBtn.addEventListener("click", () => {
          updateTimestamp();
          loadAll(true);
        });

        elements.searchInput.addEventListener("input", (event) => {
          state.searchTerm = event.target.value;
          renderViral();
          renderBuzz();
          renderPulse();
          renderPinterest();
        });

        elements.weatherForm.addEventListener("submit", (event) => {
          event.preventDefault();
          loadWeather(true);
        });

        window.addEventListener("scroll", () => {
          const header = document.querySelector(".header");
          header.classList.toggle("header--scrolled", window.scrollY > 8);
        });
      }

      function loadAll(force = false) {
        loadViral(force);
        loadBuzz(force);
        loadPulse(force);
        loadPinterest(force);
        loadFx(force);
        loadWeather(force);
      }

      attachEvents();
      loadAll(false);
    </script>
  </body>
</html>
